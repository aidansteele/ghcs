os:
  - linux

cache:
  directories:
    - $HOME/Nim
    - $HOME/nimble
    - $HOME/.nimble

language: c

install:
  - |
      git clone https://github.com/nim-lang/Nim.git $HOME/Nim
      cd $HOME/Nim
      sh bootstrap.sh
      export PATH=`pwd`/bin:$PATH
      cd -

      git clone https://github.com/nim-lang/nimble.git $HOME/nimble
      cd $HOME/nimble
      git clone -b v0.13.0 --depth 1 https://github.com/nim-lang/nim vendor/nim
      nim c -r src/nimble install
      cd -


before_script:
  - set -e
  - set -x
  - export PATH=$HOME/Nim/bin:$HOME/.nimble/bin:$PATH

script:
  - echo $PATH
  - cd src && make ghcs
